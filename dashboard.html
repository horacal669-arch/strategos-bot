<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard - STRATEGOS.HC</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
:root{--primary:#8b5cf6;--secondary:#6366f1;--success:#10b981;--danger:#ef4444;--warning:#f59e0b;--dark:#0f172a;--darker:#020617;--card:rgba(30,41,59,0.95);--text:#e2e8f0;--dim:#94a3b8;--border:rgba(139,92,246,0.2)}
body{font-family:Inter,sans-serif;background:var(--darker);color:var(--text);overflow-x:hidden}

.bg-animated{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;background:radial-gradient(ellipse at 20% 20%,rgba(139,92,246,0.15),transparent 50%),radial-gradient(ellipse at 80% 80%,rgba(99,102,241,0.15),transparent 50%);animation:bgFloat 20s ease-in-out infinite}
@keyframes bgFloat{0%,100%{transform:translate(0,0)}50%{transform:translate(20px,20px)}}

.container{position:relative;z-index:1;max-width:1800px;margin:0 auto;padding:20px}

/* Header */
.header{background:linear-gradient(135deg,rgba(139,92,246,0.1),rgba(99,102,241,0.05));backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:20px;padding:30px;margin-bottom:25px;box-shadow:0 20px 60px rgba(0,0,0,0.5)}
.header-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;flex-wrap:wrap;gap:20px}
.logo-box{display:flex;align-items:center;gap:15px}
.logo-icon{width:50px;height:50px;background:linear-gradient(135deg,var(--primary),var(--secondary));border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:28px;font-weight:900;color:white;box-shadow:0 10px 30px rgba(139,92,246,0.5)}
.logo-text h1{font-size:clamp(24px,4vw,32px);font-weight:900;background:linear-gradient(135deg,var(--primary),var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:5px}
.logo-text p{font-size:12px;color:var(--dim);font-weight:600;text-transform:uppercase;letter-spacing:1.5px}
.status-badges{display:flex;gap:10px;flex-wrap:wrap}
.badge{padding:10px 20px;border-radius:50px;font-weight:700;font-size:12px;display:flex;align-items:center;gap:8px;backdrop-filter:blur(10px);border:1px solid;transition:all 0.3s}
.badge-plan{background:rgba(139,92,246,0.2);border-color:var(--primary);color:var(--primary)}
.badge-mode{background:rgba(16,185,129,0.2);border-color:var(--success);color:var(--success)}
.status-dot{width:8px;height:8px;border-radius:50%;background:currentColor;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}

/* Stats Grid */
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:25px}
.stat-card{background:var(--card);backdrop-filter:blur(10px);padding:25px;border-radius:16px;border:1px solid var(--border);transition:all 0.3s;position:relative;overflow:hidden}
.stat-card::before{content:'';position:absolute;top:0;left:0;width:100%;height:3px;background:linear-gradient(90deg,var(--primary),var(--secondary));transform:scaleX(0);transition:transform 0.5s}
.stat-card:hover{transform:translateY(-5px);border-color:var(--primary);box-shadow:0 15px 40px rgba(139,92,246,0.3)}
.stat-card:hover::before{transform:scaleX(1)}
.stat-icon{font-size:36px;margin-bottom:12px}
.stat-label{color:var(--dim);font-size:12px;text-transform:uppercase;letter-spacing:1px;font-weight:700;margin-bottom:10px}
.stat-value{font-size:clamp(28px,4vw,36px);font-weight:900;line-height:1;margin-bottom:8px}
.stat-change{font-size:14px;font-weight:700;display:flex;align-items:center;gap:5px}
.positive{color:var(--success)}
.negative{color:var(--danger)}

/* Main Grid */
.main-grid{display:grid;grid-template-columns:2fr 1fr;gap:20px;margin-bottom:20px}
.card{background:var(--card);backdrop-filter:blur(20px);border-radius:20px;padding:30px;border:1px solid var(--border);box-shadow:0 10px 40px rgba(0,0,0,0.4)}
.card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;padding-bottom:15px;border-bottom:2px solid var(--border)}
.card-title{font-size:clamp(18px,3vw,22px);font-weight:900;display:flex;align-items:center;gap:10px;color:var(--primary)}
.chart-container{position:relative;height:350px}

/* Operations Table */
.ops-table{width:100%;border-collapse:collapse}
.ops-table th{text-align:left;padding:12px;color:var(--dim);font-size:12px;text-transform:uppercase;letter-spacing:1px;border-bottom:1px solid var(--border)}
.ops-table td{padding:12px;border-bottom:1px solid rgba(255,255,255,0.05);font-size:14px}
.op-tag{font-weight:800;color:var(--primary)}
.op-side{padding:4px 10px;border-radius:6px;font-size:11px;font-weight:700}
.op-long{background:rgba(16,185,129,0.2);color:var(--success)}
.op-short{background:rgba(239,68,68,0.2);color:var(--danger)}

/* Controls */
.controls{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px}
.btn{padding:14px 20px;border:none;border-radius:10px;font-weight:800;cursor:pointer;transition:all 0.3s;font-size:14px;text-transform:uppercase;letter-spacing:0.5px;position:relative;overflow:hidden}
.btn::before{content:'';position:absolute;top:50%;left:50%;width:0;height:0;background:rgba(255,255,255,0.2);border-radius:50%;transform:translate(-50%,-50%);transition:width 0.6s,height 0.6s}
.btn:hover::before{width:400px;height:400px}
.btn:active{transform:scale(0.95)}
.btn-primary{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;box-shadow:0 8px 20px rgba(139,92,246,0.4)}
.btn-success{background:linear-gradient(135deg,var(--success),#059669);color:white}
.btn-danger{background:linear-gradient(135deg,var(--danger),#dc2626);color:white}
.btn-warning{background:linear-gradient(135deg,var(--warning),#d97706);color:white}
.btn-secondary{background:rgba(255,255,255,0.05);color:var(--text);border:1px solid var(--border)}

/* Responsive */
@media (max-width:1200px){
.main-grid{grid-template-columns:1fr}
}
@media (max-width:768px){
.header-top{flex-direction:column;align-items:flex-start}
.stats-grid{grid-template-columns:1fr}
.controls{grid-template-columns:1fr}
.ops-table{font-size:12px}
.ops-table th,.ops-table td{padding:8px}
}
</style>
</head>
<body>
<div class="bg-animated"></div>
<div class="container">

<!-- Header -->
<div class="header">
<div class="header-top">
<div class="logo-box">
<div class="logo-icon">S</div>
<div class="logo-text">
<h1>STRATEGOS.HC</h1>
<p>Pro Dashboard</p>
</div>
</div>
<div class="status-badges">
<div class="badge badge-plan"><span id="plan-badge">FREE</span></div>
<div class="badge badge-mode">
<div class="status-dot"></div>
<span id="modo-badge">DEMO</span>
</div>
</div>
</div>

<!-- Stats -->
<div class="stats-grid">
<div class="stat-card">
<div class="stat-icon">ğŸ’°</div>
<div class="stat-label">P&L Total</div>
<div class="stat-value positive" id="pnl">$0.00</div>
<div class="stat-change positive"><span>â†‘</span><span id="pnl-change">Cargando...</span></div>
</div>
<div class="stat-card">
<div class="stat-icon">ğŸ¯</div>
<div class="stat-label">Win Rate</div>
<div class="stat-value" id="wr">0%</div>
<div class="stat-change"><span id="ops-breakdown">0WÂ·0LÂ·0BE</span></div>
</div>
<div class="stat-card">
<div class="stat-icon">ğŸ“Š</div>
<div class="stat-label">Operaciones</div>
<div class="stat-value" id="ops">0</div>
<div class="stat-change" id="ops-activas">0 activas</div>
</div>
<div class="stat-card">
<div class="stat-icon">ğŸ’¼</div>
<div class="stat-label">Saldo Disponible</div>
<div class="stat-value" id="saldo">$0.00</div>
<div class="stat-change" id="saldo-change">Binance Futures</div>
</div>
</div>
</div>

<!-- Main Grid -->
<div class="main-grid">
<!-- Chart -->
<div class="card">
<div class="card-header">
<div class="card-title"><span>ğŸ“ˆ</span><span>P&L Real-Time</span></div>
</div>
<div class="chart-container"><canvas id="chart"></canvas></div>
</div>

<!-- Info -->
<div class="card">
<div class="card-header">
<div class="card-title"><span>â„¹ï¸</span><span>Estado</span></div>
</div>
<p style="color:var(--success);font-size:16px;font-weight:700;margin-bottom:15px" id="status">âœ… Bot activo</p>
<div style="font-size:13px;color:var(--dim);line-height:1.8">
<p><strong>Ãšltima actualizaciÃ³n:</strong> <span id="last-update">--:--</span></p>
<p><strong>PrÃ³ximo anÃ¡lisis:</strong> <span id="next-scan">5:00</span></p>
<p><strong>Ops mÃ¡ximas:</strong> <span id="max-ops">5</span></p>
</div>
</div>
</div>

<!-- Operaciones Activas -->
<div class="card">
<div class="card-header">
<div class="card-title"><span>ğŸ“‹</span><span>Operaciones Activas</span></div>
</div>
<table class="ops-table">
<thead>
<tr>
<th>TAG</th>
<th>PAR</th>
<th>TIPO</th>
<th>ENTRY</th>
<th>P&L</th>
<th>TPs</th>
</tr>
</thead>
<tbody id="ops-tbody">
<tr><td colspan="6" style="text-align:center;color:var(--dim);padding:30px">Sin operaciones activas</td></tr>
</tbody>
</table>
</div>

<!-- Controls -->
<div class="card">
<div class="card-header">
<div class="card-title"><span>ğŸ®</span><span>Panel de Control</span></div>
</div>
<div class="controls">
<button class="btn btn-primary" onclick="verStats()">ğŸ“Š Stats</button>
<button class="btn btn-primary" onclick="verActivas()">ğŸ“ˆ Activas</button>
<button class="btn btn-primary" onclick="verBalance()">ğŸ’° Balance</button>
<button class="btn btn-primary" onclick="verSaldo()">ğŸ’¼ Saldo</button>
<button class="btn btn-success" onclick="cerrarOp()">ğŸ’µ Cerrar OP</button>
<button class="btn btn-secondary" onclick="pausar()">â¸ï¸ Pausar</button>
<button class="btn btn-secondary" onclick="cambiarModo()">ğŸ”„ Modo</button>
<button class="btn btn-warning" onclick="cerrarCiclo()">â¹ï¸ Ciclo</button>
<button class="btn btn-secondary" onclick="config()">âš™ï¸ Config</button>
<button class="btn btn-danger" onclick="reset()">ğŸ—‘ï¸ Reset</button>
</div>
</div>

</div>

<script>
// Chart
const ctx=document.getElementById('chart').getContext('2d');
const gradient=ctx.createLinearGradient(0,0,0,400);
gradient.addColorStop(0,'rgba(139,92,246,0.4)');
gradient.addColorStop(1,'rgba(139,92,246,0)');
const chart=new Chart(ctx,{type:'line',data:{labels:[],datasets:[{label:'P&L',data:[],borderColor:'#8b5cf6',backgroundColor:gradient,borderWidth:4,tension:0.4,fill:true,pointRadius:6,pointBackgroundColor:'#8b5cf6',pointBorderColor:'#0f172a',pointBorderWidth:3}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{backgroundColor:'rgba(30,41,59,0.95)',titleColor:'#e2e8f0',bodyColor:'#8b5cf6',borderColor:'#8b5cf6',borderWidth:2,padding:15}},scales:{x:{grid:{color:'rgba(139,92,246,0.1)'},ticks:{color:'#94a3b8'}},y:{grid:{color:'rgba(139,92,246,0.1)'},ticks:{color:'#94a3b8',callback:v=>`$${v}`}}}}});

function cargarStats(){
fetch('/api/stats',{credentials:'include'})
.then(r=>r.json())
.then(d=>{
document.getElementById('pnl').textContent='$'+d.total_pnl.toFixed(2);
document.getElementById('pnl').className='stat-value '+(d.total_pnl>=0?'positive':'negative');
document.getElementById('wr').textContent=d.win_rate+'%';
document.getElementById('ops').textContent=d.total_ops;
document.getElementById('ops-breakdown').textContent=`${d.wins}WÂ·${d.losses}LÂ·${d.be}BE`;
document.getElementById('pnl-change').textContent=(d.total_pnl>=0?'+':'')+d.total_pnl.toFixed(2)+' total';
document.getElementById('last-update').textContent=new Date().toLocaleTimeString('es-AR',{hour:'2-digit',minute:'2-digit'});

const now=new Date().toLocaleTimeString('es-AR',{hour:'2-digit',minute:'2-digit'});
if(chart.data.labels.length>20){chart.data.labels.shift();chart.data.datasets[0].data.shift()}
chart.data.labels.push(now);
chart.data.datasets[0].data.push(d.total_pnl);
chart.update('none');
}).catch(()=>document.getElementById('status').textContent='âš ï¸ Desconectado');
}

function pausar(){alert('â¸ï¸ Bot pausado (implementar en Telegram)')}
function cambiarModo(){alert('ğŸ”„ Cambiar modo (implementar)')}
function cerrarCiclo(){alert('â¹ï¸ Cerrar ciclo (implementar)')}
function reset(){if(confirm('Â¿Resetear TODO?')){alert('ğŸ—‘ï¸ Reset')}}
function verStats(){alert('ğŸ“Š Ver stats completas')}
function verActivas(){alert('ğŸ“ˆ Ver operaciones activas')}
function verBalance(){alert('ğŸ’° Ver balance detallado')}
function verSaldo(){alert('ğŸ’¼ Consultando saldo Binance...')}
function cerrarOp(){alert('ğŸ’µ Selecciona operaciÃ³n a cerrar')}
function config(){window.location.href='onboarding.html'}

cargarStats();
setInterval(cargarStats,5000);
</script>
</body>
</html>
